{"version":3,"sources":["../../../src/components/View/View.tsx"],"names":["transitionStartEventName","transitionEndEventName","SwipeBackResults","scrollsCache","swipeBackExcludedTags","View","props","e","includes","animationName","activePanel","isBack","state","prevPanel","document","dispatchEvent","window","CustomEvent","setState","nextPanel","visiblePanels","animated","undefined","scrolls","scrollTo","onTransition","from","to","target","propertyName","classList","contains","swipeBackResult","fail","onSwipeBackCancel","success","onSwipeBackSuccess","scrollTop","body","documentElement","duration","timing","n","Math","sqrt","draw","val","originalEvent","tagName","toLowerCase","platform","IOS","context","isWebView","startX","innerWidth","browserSwipe","onSwipeBack","swipingBack","history","length","swipebackStartX","startT","swipeBackPrevPanel","swipeBackNextPanel","slice","pageYOffset","swipeBackShift","shiftX","speed","Date","now","id","prevProps","prevState","popout","blurActiveElement","modal","firstLayer","panels","find","panel","detail","nextPanelElement","pickPanel","prevPanelElement","waitAnimationFinish","transitionEndHandler","onSwipeBackStart","waitTransitionFinish","swipingBackTransitionEndHandler","elem","eventHandler","transitionEvents","supported","eventName","prefix","removeEventListener","addEventListener","setTimeout","ANDROID","activeElement","blur","getElementById","console","warn","parentNode","panelId","isPrev","isNext","prevPanelTranslate","nextPanelTranslate","prevPanelShadow","boxShadow","transform","WebkitTransform","title","left","addon","right","opacity","titleTransform","leftTransform","style","header","hasPopout","hasModal","filter","modifiers","className","onMoveX","onEnd","onScrollTop","map","headerSwipeStyles","calcHeaderSwipeStyles","calcPanelSwipeStyles","concat","children","Component","PropTypes","bool","any"],"mappings":"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","sourcesContent":["/* eslint-disable */\n\nimport React, { Component, CSSProperties, HTMLAttributes, ReactNode } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from '../../lib/classNames';\nimport animate from '../../lib/animate';\nimport transitionEvents from '../../lib/transitionEvents';\nimport getClassName from '../../helpers/getClassName';\nimport { IOS, ANDROID } from '../../lib/platform';\nimport Touch from '../Touch/Touch';\nimport removeObjectKeys from '../../lib/removeObjectKeys';\nimport { HasChildren, HasPlatform } from '../../types/props';\nimport withPlatform from '../../hoc/withPlatform';\n\nexport const transitionStartEventName = 'VKUI:View:transition-start';\nexport const transitionEndEventName = 'VKUI:View:transition-end';\n\nenum SwipeBackResults { fail = 1, success}\n\ninterface Scrolls {\n  [index: string]: number;\n}\n\nexport type TransitionStartEventDetail = {\n  scrolls: Scrolls\n}\n\ninterface ViewsScrolls {\n  [index: string]: Scrolls;\n}\n\ntype AnimationEventHandler = (e?: AnimationEvent) => void;\n\ntype TransitionEventHandler = (e?: TransitionEvent) => void;\n\ninterface HeaderSwipeStyles {\n  title?: CSSProperties;\n  left?: CSSProperties;\n  addon?: CSSProperties;\n  right?: CSSProperties;\n}\n\nlet scrollsCache: ViewsScrolls = {};\n\nconst swipeBackExcludedTags = ['input', 'textarea'];\n\nexport interface ViewProps extends HTMLAttributes<HTMLElement>, HasChildren, HasPlatform {\n  activePanel: string;\n  header?: boolean;\n  popout?: ReactNode;\n  modal?: ReactNode;\n  onTransition?(params: { isBack: boolean; from: string; to: string }): void;\n  onSwipeBack?(): void;\n  onSwipeBackStart?(): void;\n  history?: string[];\n  id?: string;\n}\n\nexport interface ViewState {\n  scrolls: Scrolls;\n  animated: boolean;\n  startT?: number;\n\n  visiblePanels: string[];\n  activePanel: string;\n  isBack: boolean;\n  prevPanel: string;\n  nextPanel: string;\n\n  swipingBack: boolean;\n  swipebackStartX: number;\n  swipeBackShift: number;\n  swipeBackNextPanel: string;\n  swipeBackPrevPanel: string;\n  swipeBackResult: SwipeBackResults;\n\n  browserSwipe: boolean;\n}\n\nclass View extends Component<ViewProps, ViewState> {\n  constructor(props: ViewProps) {\n    super(props);\n    this.state = {\n      scrolls: scrollsCache[props.id] || {},\n      animated: false,\n\n      visiblePanels: [props.activePanel],\n      activePanel: props.activePanel,\n      isBack: undefined,\n      prevPanel: null,\n      nextPanel: null,\n\n      swipingBack: false,\n      swipebackStartX: 0,\n      swipeBackShift: 0,\n      swipeBackNextPanel: null,\n      swipeBackPrevPanel: null,\n      swipeBackResult: null,\n\n      browserSwipe: false,\n    };\n  }\n\n  static defaultProps: Partial<ViewProps> = {\n    header: true,\n    history: [],\n  };\n\n  static contextTypes = {\n    isWebView: PropTypes.bool,\n    window: PropTypes.any,\n    document: PropTypes.any,\n  };\n\n  get document() {\n    return this.context.document || document;\n  }\n\n  get window() {\n    return this.context.window || window;\n  }\n\n  get panels() {\n    return [].concat(this.props.children);\n  }\n\n  componentWillUnmount() {\n    if (this.props.id) {\n      scrollsCache[this.props.id] = this.state.scrolls;\n    }\n  }\n\n  componentDidUpdate(prevProps: ViewProps, prevState: ViewState) {\n    this.props.popout && !prevProps.popout && this.blurActiveElement();\n    this.props.modal && !prevProps.modal && this.blurActiveElement();\n\n    // Нужен переход\n    if (prevProps.activePanel !== this.props.activePanel && !prevState.swipingBack && !prevState.browserSwipe) {\n      const firstLayer = this.panels.find(\n        (panel: React.ReactElement) => panel.props.id === prevProps.activePanel || panel.props.id === this.props.activePanel\n      );\n\n      const isBack = firstLayer && firstLayer.props.id === this.props.activePanel;\n\n      this.blurActiveElement();\n\n      this.setState({\n        visiblePanels: [prevProps.activePanel, this.props.activePanel],\n        prevPanel: prevProps.activePanel,\n        nextPanel: this.props.activePanel,\n        activePanel: null,\n        animated: true,\n        scrolls: {\n          ...prevState.scrolls,\n          [prevProps.activePanel]: this.window.pageYOffset,\n        },\n        isBack,\n      });\n    }\n\n    // Закончилась анимация свайпа назад\n    if (prevProps.activePanel !== this.props.activePanel && prevState.swipingBack) {\n      const nextPanel = this.props.activePanel;\n      const prevPanel = prevProps.activePanel;\n      this.setState({\n        swipeBackPrevPanel: null,\n        swipeBackNextPanel: null,\n        swipingBack: false,\n        swipeBackResult: null,\n        swipebackStartX: 0,\n        swipeBackShift: 0,\n        activePanel: nextPanel,\n        visiblePanels: [nextPanel],\n        scrolls: removeObjectKeys(prevState.scrolls, [prevState.swipeBackPrevPanel]),\n      }, () => {\n        this.document.dispatchEvent(new this.window.CustomEvent(transitionEndEventName));\n        window.scrollTo(0, prevState.scrolls[this.state.activePanel]);\n        prevProps.onTransition && prevProps.onTransition({ isBack: true, from: prevPanel, to: nextPanel });\n      });\n    }\n\n    const scrolls = this.state.scrolls;\n\n    // Начался переход\n    if (!prevState.animated && this.state.animated) {\n      this.document.dispatchEvent(new this.window.CustomEvent(transitionStartEventName, { detail: { scrolls } }));\n      const nextPanelElement = this.pickPanel(this.state.nextPanel);\n      const prevPanelElement = this.pickPanel(this.state.prevPanel);\n\n      prevPanelElement.scrollTop = scrolls[this.state.prevPanel];\n      if (this.state.isBack) {\n        nextPanelElement.scrollTop = scrolls[this.state.nextPanel];\n      }\n      this.waitAnimationFinish(this.pickPanel(this.state.isBack ? this.state.prevPanel : this.state.nextPanel), this.transitionEndHandler);\n    }\n\n    // Начался свайп назад\n    if (!prevState.swipingBack && this.state.swipingBack) {\n      this.document.dispatchEvent(new this.window.CustomEvent(transitionStartEventName, { detail: { scrolls } }));\n      this.props.onSwipeBackStart && this.props.onSwipeBackStart();\n      const nextPanelElement = this.pickPanel(this.state.swipeBackNextPanel);\n      const prevPanelElement = this.pickPanel(this.state.swipeBackPrevPanel);\n\n      nextPanelElement.scrollTop = scrolls[this.state.swipeBackNextPanel];\n      prevPanelElement.scrollTop = scrolls[this.state.swipeBackPrevPanel];\n    }\n\n    // Началась анимация завершения свайпа назад.\n    if (!prevState.swipeBackResult && this.state.swipeBackResult) {\n      this.waitTransitionFinish(this.pickPanel(this.state.swipeBackNextPanel), this.swipingBackTransitionEndHandler);\n    }\n\n    // Если свайп назад отменился (когда пользователь недостаточно сильно свайпнул)\n    if (prevState.swipeBackResult === SwipeBackResults.fail && !this.state.swipeBackResult) {\n      this.window.scrollTo(0, scrolls[this.state.activePanel]);\n    }\n\n    // Закончился Safari свайп\n    if (prevProps.activePanel !== this.props.activePanel && this.state.browserSwipe) {\n      this.setState({\n        browserSwipe: false,\n        nextPanel: null,\n        prevPanel: null,\n        animated: false,\n        visiblePanels: [this.props.activePanel],\n        activePanel: this.props.activePanel,\n      });\n    }\n  }\n\n  waitTransitionFinish(elem: HTMLElement, eventHandler: TransitionEventHandler): void {\n    if (transitionEvents.supported) {\n      const eventName = transitionEvents.prefix ? transitionEvents.prefix + 'TransitionEnd' : 'transitionend';\n\n      elem.removeEventListener(eventName, eventHandler);\n      elem.addEventListener(eventName, eventHandler);\n    } else {\n      setTimeout(() => eventHandler(), this.props.platform === ANDROID ? 300 : 600);\n    }\n  }\n\n  waitAnimationFinish(elem: HTMLElement, eventHandler: AnimationEventHandler): void {\n    if (transitionEvents.supported) {\n      const eventName = transitionEvents.prefix ? transitionEvents.prefix + 'AnimationEnd' : 'animationend';\n\n      elem.removeEventListener(eventName, eventHandler);\n      elem.addEventListener(eventName, eventHandler);\n    } else {\n      setTimeout(() => eventHandler(), this.props.platform === ANDROID ? 300 : 600);\n    }\n  }\n\n  blurActiveElement(): void {\n    if (typeof this.window !== 'undefined' && this.document.activeElement) {\n      this.document.activeElement.blur();\n    }\n  }\n\n  pickPanel(id: string): HTMLElement {\n    const elem = this.document.getElementById(id);\n\n    if (!elem) {\n      console.warn(`Element #${id} not found`);\n    }\n\n    return elem && elem.parentNode.parentNode;\n  }\n\n  transitionEndHandler = (e?: AnimationEvent): void => {\n    if (!e || [\n      'animation-ios-next-forward',\n      'animation-ios-prev-back',\n      'animation-android-next-forward',\n      'animation-android-prev-back',\n    ].includes(e.animationName)) {\n      const activePanel = this.props.activePanel;\n      const isBack = this.state.isBack;\n      const prevPanel = this.state.prevPanel;\n      this.document.dispatchEvent(new this.window.CustomEvent(transitionEndEventName));\n      this.setState({\n        prevPanel: null,\n        nextPanel: null,\n        visiblePanels: [activePanel],\n        activePanel: activePanel,\n        animated: false,\n        isBack: undefined,\n        scrolls: isBack ? removeObjectKeys(this.state.scrolls, [prevPanel]) : this.state.scrolls,\n      }, () => {\n        isBack && this.window.scrollTo(0, this.state.scrolls[activePanel]);\n        this.props.onTransition && this.props.onTransition({ isBack, from: prevPanel, to: activePanel });\n      });\n    }\n  };\n\n  swipingBackTransitionEndHandler = (e?: TransitionEvent): void => {\n    // indexOf because of vendor prefixes in old browsers\n    const target = e.target as HTMLElement;\n    if (e.propertyName.includes('transform') && target.classList.contains('View__panel--swipe-back-next')) {\n      switch (this.state.swipeBackResult) {\n        case SwipeBackResults.fail:\n          this.onSwipeBackCancel();\n          break;\n        case SwipeBackResults.success:\n          this.onSwipeBackSuccess();\n      }\n    }\n  };\n\n  onSwipeBackSuccess(): void {\n    this.props.onSwipeBack && this.props.onSwipeBack();\n  }\n\n  onSwipeBackCancel(): void {\n    this.setState({\n      swipeBackPrevPanel: null,\n      swipeBackNextPanel: null,\n      swipingBack: false,\n      swipeBackResult: null,\n      swipebackStartX: 0,\n      swipeBackShift: 0,\n    }, () => {\n      this.document.dispatchEvent(new this.window.CustomEvent(transitionEndEventName));\n    });\n  }\n\n  onScrollTop = (): void => {\n    const { activePanel } = this.state;\n\n    if (activePanel) {\n      const scrollTop = this.document.body.scrollTop || this.document.documentElement.scrollTop;\n\n      if (scrollTop) {\n        animate({\n          duration: 200,\n          timing: (n: number) => Math.sqrt(n),\n          draw: (val: number) => {\n            this.window.scrollTo(0, scrollTop - val * scrollTop);\n          },\n        });\n      }\n    }\n  };\n\n  onMoveX = (e): void => {\n    if (\n      e.originalEvent.target &&\n      typeof e.originalEvent.target.tagName === 'string' &&\n      swipeBackExcludedTags.includes(e.originalEvent.target.tagName.toLowerCase())\n    ) {\n      return;\n    }\n\n    const { platform } = this.props;\n\n    if (platform === IOS && !this.context.isWebView && (e.startX <= 70 || e.startX >= this.window.innerWidth - 70) && !this.state.browserSwipe) {\n      this.setState({ browserSwipe: true });\n    }\n\n    if (platform === IOS && this.context.isWebView && this.props.onSwipeBack) {\n      if (this.state.animated && e.startX <= 70) {\n        return;\n      }\n\n      if (e.startX <= 70 && !this.state.swipingBack && this.props.history.length > 1) {\n        this.setState({\n          swipingBack: true,\n          swipebackStartX: e.startX,\n          startT: e.startT,\n          swipeBackPrevPanel: this.state.activePanel,\n          swipeBackNextPanel: this.props.history.slice(-2)[0],\n          scrolls: {\n            ...this.state.scrolls,\n            [this.state.activePanel]: this.window.pageYOffset,\n          },\n        });\n      }\n      if (this.state.swipingBack) {\n        let swipeBackShift;\n        if (e.shiftX < 0) {\n          swipeBackShift = 0;\n        } else if (e.shiftX > this.window.innerWidth - this.state.swipebackStartX) {\n          swipeBackShift = this.window.innerWidth;\n        } else {\n          swipeBackShift = e.shiftX;\n        }\n        this.setState({ swipeBackShift });\n      }\n    }\n  };\n\n  onEnd = (): void => {\n    if (this.state.swipingBack) {\n      const speed = this.state.swipeBackShift / (Date.now() - this.state.startT) * 1000;\n      if (this.state.swipeBackShift === 0) {\n        this.onSwipeBackCancel();\n      } else if (this.state.swipeBackShift >= this.window.innerWidth) {\n        this.onSwipeBackSuccess();\n      } else if (speed > 250 || this.state.swipebackStartX + this.state.swipeBackShift > this.window.innerWidth / 2) {\n        this.setState({ swipeBackResult: SwipeBackResults.success });\n      } else {\n        this.setState({ swipeBackResult: SwipeBackResults.fail });\n      }\n    }\n  };\n\n  calcPanelSwipeStyles(panelId: string): CSSProperties {\n    const isPrev = panelId === this.state.swipeBackPrevPanel;\n    const isNext = panelId === this.state.swipeBackNextPanel;\n\n    if (!isPrev && !isNext || this.state.swipeBackResult) {\n      return {};\n    }\n\n    let prevPanelTranslate = `${this.state.swipeBackShift}px`;\n    let nextPanelTranslate = `${-50 + this.state.swipeBackShift * 100 / this.window.innerWidth / 2}%`;\n    let prevPanelShadow = 0.3 * (this.window.innerWidth - this.state.swipeBackShift) / this.window.innerWidth;\n\n    if (this.state.swipeBackResult) {\n      return isPrev ? { boxShadow: `-2px 0 12px rgba(0, 0, 0, ${prevPanelShadow})` } : {};\n    }\n\n    if (isNext) {\n      return {\n        transform: `translate3d(${nextPanelTranslate}, 0, 0)`,\n        WebkitTransform: `translate3d(${nextPanelTranslate}, 0, 0)`,\n      };\n    }\n    if (isPrev) {\n      return {\n        transform: `translate3d(${prevPanelTranslate}, 0, 0)`,\n        WebkitTransform: `translate3d(${prevPanelTranslate}, 0, 0)`,\n        boxShadow: `-2px 0 12px rgba(0, 0, 0, ${prevPanelShadow})`,\n      };\n    }\n\n    return {};\n  }\n\n  calcHeaderSwipeStyles(panelId: string): HeaderSwipeStyles {\n    const isPrev = panelId === this.state.swipeBackPrevPanel;\n    const isNext = panelId === this.state.swipeBackNextPanel;\n\n    if (!isPrev && !isNext || this.state.swipeBackResult !== null) {\n      return {\n        title: {},\n        left: {},\n        addon: {},\n        right: {},\n      };\n    }\n\n    let opacity = this.state.swipeBackShift / this.window.innerWidth;\n    let titleTransform = this.state.swipeBackShift / this.window.innerWidth * 30;\n    let leftTransform = this.state.swipeBackShift / this.window.innerWidth * 30;\n\n    if (isNext) {\n      return {\n        title: {\n          transform: `translate3d(${-30 + titleTransform}vw, 0, 0)`,\n          WebkitTransform: `translate3d(${-30 + titleTransform}vw, 0, 0)`,\n          opacity,\n        },\n        left: { opacity },\n        addon: {\n          opacity: 1,\n          transform: `translate3d(${-30 + leftTransform}vw, 0, 0)`,\n          WebkitTransform: `translate3d(${-30 + leftTransform}vw, 0, 0)`,\n        },\n        right: { opacity },\n      };\n    }\n    if (isPrev) {\n      return {\n        title: {\n          transform: `translate3d(${titleTransform}vw, 0, 0)`,\n          WebkitTransform: `translate3d(${titleTransform}vw, 0, 0)`,\n          opacity: 1 - opacity,\n        },\n        left: { opacity: 1 - opacity },\n        addon: {\n          transform: `translate3d(${leftTransform}vw, 0, 0)`,\n          WebkitTransform: `translate3d(${leftTransform}vw, 0, 0)`,\n          opacity: 1 - opacity,\n        },\n      };\n    }\n\n    return {};\n  }\n\n  render() {\n    const { style, popout, modal, header, platform } = this.props;\n    const { prevPanel, nextPanel, activePanel, swipeBackPrevPanel, swipeBackNextPanel, swipeBackResult } = this.state;\n\n    const hasPopout = !!popout;\n    const hasModal = !!modal;\n\n    const panels = this.panels.filter((panel: React.ReactElement) => {\n      const panelId = panel.props.id;\n\n      return this.state.visiblePanels.includes(panelId) ||\n        panelId === swipeBackPrevPanel ||\n        panelId === swipeBackNextPanel;\n    });\n\n    const modifiers = {\n      'View--header': header,\n      'View--animated': this.state.animated,\n      'View--swiping-back': this.state.swipingBack,\n    };\n\n    return (\n      <Touch\n        Component=\"section\"\n        className={classNames(getClassName('View', platform), this.props.className, modifiers)}\n        style={style}\n        onMoveX={this.onMoveX}\n        onEnd={this.onEnd}\n      >\n        {header &&\n          <div className=\"View__header\">\n            {platform === IOS && <div className=\"View__header-scrolltop\" onClick={this.onScrollTop} />}\n            <div className={classNames(getClassName('PanelHeader', platform))}>\n              {panels.map((panel: React.ReactElement) => {\n                const panelId = panel.props.id;\n                const headerSwipeStyles = this.calcHeaderSwipeStyles(panelId);\n\n                return (\n                  <div\n                    className={classNames('PanelHeader__in', {\n                      'PanelHeader__in--active': panelId === activePanel,\n                      'PanelHeader__in--prev': panelId === prevPanel,\n                      'PanelHeader__in--next': panelId === nextPanel,\n                      'PanelHeader__in--swipe-back-prev': panelId === swipeBackPrevPanel,\n                      'PanelHeader__in--swipe-back-next': panelId === swipeBackNextPanel,\n                      'PanelHeader__in--swipe-back-success': swipeBackResult === SwipeBackResults.success,\n                      'PanelHeader__in--swipe-back-failed': swipeBackResult === SwipeBackResults.fail,\n                    })}\n                    key={panelId}\n                    id={`panel-header-${panelId}`}\n                  >\n                    <div className=\"PanelHeader__container\">\n                      <div className=\"PanelHeader__left\">\n                        <div\n                          className=\"PanelHeader__left-in\"\n                          id={`header-left-${panelId}`}\n                          style={headerSwipeStyles.left}\n                        />\n                        {platform === IOS &&\n                        <div\n                          className=\"PanelHeader__addon\"\n                          id={`header-addon-${panelId}`}\n                          style={headerSwipeStyles.addon}\n                        />\n                        }\n                      </div>\n                      <div\n                        className=\"PanelHeader__content\"\n                        style={headerSwipeStyles.title}\n                        id={`header-title-${panelId}`}\n                      />\n                      <div\n                        className=\"PanelHeader__right\"\n                        id={`header-right-${panelId}`}\n                        style={headerSwipeStyles.right}\n                      />\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        }\n        <div className=\"View__panels\">\n          {panels.map((panel: React.ReactElement) => {\n            const panelId = panel.props.id;\n\n            return (\n              <div\n                className={classNames('View__panel', {\n                  'View__panel--active': panelId === activePanel,\n                  'View__panel--prev': panelId === prevPanel,\n                  'View__panel--next': panelId === nextPanel,\n                  'View__panel--swipe-back-prev': panelId === swipeBackPrevPanel,\n                  'View__panel--swipe-back-next': panelId === swipeBackNextPanel,\n                  'View__panel--swipe-back-success': swipeBackResult === SwipeBackResults.success,\n                  'View__panel--swipe-back-failed': swipeBackResult === SwipeBackResults.fail,\n                })}\n                style={this.calcPanelSwipeStyles(panelId)}\n                key={panelId}\n              >\n                <div className=\"View__panel-in\">\n                  {panel}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n        {hasPopout && <div className=\"View__popout\">{popout}</div>}\n        {hasModal && <div className=\"View__modal\">{modal}</div>}\n      </Touch>\n    );\n  }\n}\n\nexport default withPlatform(View);\n"],"file":"View.js"}