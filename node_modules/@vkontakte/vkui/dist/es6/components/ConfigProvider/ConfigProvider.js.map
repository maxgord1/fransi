{"version":3,"sources":["../../../../src/components/ConfigProvider/ConfigProvider.tsx"],"names":["React","PropTypes","vkBridge","canUseDOM","ConfigProviderContext","ConfigProvider","props","context","setScheme","document","window","body","mapOldScheme","scheme","target","setAttribute","prevProps","isWebView","webviewType","app","getChildContext","children","Component","bool","string","oneOf","object"],"mappings":";;;;;;AAAA,OAAOA,KAAP,MAAiC,OAAjC;AACA,OAAOC,SAAP,MAAuC,YAAvC;AACA,OAAOC,QAAP,MAAqB,sBAArB;AACA,SAASC,SAAT,QAA0B,eAA1B;AACA,OAAOC,qBAAP,MAAsE,yBAAtE;;IAqBqBC,c;;;AACnB,0BAAYC,KAAZ,EAAwCC,OAAxC,EAAwE;AAAA;;AAAA;;AACtE,wFAAMD,KAAN;;AACA,QAAIH,SAAJ,EAAe;AACb,YAAKK,SAAL,CAAe,CAACD,OAAO,CAACE,QAAR,IAAoBC,MAAM,CAACD,QAA5B,EAAsCE,IAArD,EAA2D,MAAKC,YAAL,CAAkBN,KAAK,CAACO,MAAxB,CAA3D;AACD;;AAJqE;AAKvE;;;;iCAuBYA,M,EAAuC;AAClD,cAAQA,MAAR;AACE,aAAK,cAAL;AACE,iBAAO,cAAP;;AACF,aAAK,aAAL;AACE,iBAAO,YAAP;;AACF;AACE,iBAAOA,MAAP;AANJ;AAQD;;;8BAESC,M,EAAqBD,M,EAAuC;AACpEC,MAAAA,MAAM,CAACC,YAAP,CAAoB,QAApB,EAA8BF,MAA9B;AACD;;;uCAEkBG,S,EAAgC;AACjD,UAAIA,SAAS,CAACH,MAAV,KAAqB,KAAKP,KAAL,CAAWO,MAApC,EAA4C;AAC1C,aAAKL,SAAL,CAAe,KAAKC,QAAL,CAAcE,IAA7B,EAAmC,KAAKC,YAAL,CAAkB,KAAKN,KAAL,CAAWO,MAA7B,CAAnC;AACD;AACF;;;sCAEsC;AACrC,aAAO;AACLI,QAAAA,SAAS,EAAE,KAAKX,KAAL,CAAWW,SADjB;AAELC,QAAAA,WAAW,EAAE,KAAKZ,KAAL,CAAWY,WAFnB;AAGLL,QAAAA,MAAM,EAAE,KAAKD,YAAL,CAAkB,KAAKN,KAAL,CAAWO,MAA7B,CAHH;AAILM,QAAAA,GAAG,EAAE,KAAKb,KAAL,CAAWa;AAJX,OAAP;AAMD;;;6BAEQ;AACP,aACE,oBAAC,qBAAD,CAAuB,QAAvB;AAAgC,QAAA,KAAK,EAAE,KAAKC,eAAL;AAAvC,SACG,KAAKd,KAAL,CAAWe,QADd,CADF;AAKD;;;wBAxCwB;AACvB,aAAO,KAAKd,OAAL,CAAaE,QAAb,IAAyBC,MAAM,CAACD,QAAvC;AACD;;;;EA3ByCT,KAAK,CAACsB,S;;gBAA7BjB,c,uBAQwC;AACzDY,EAAAA,SAAS,EAAEhB,SAAS,CAACsB,IADoC;AAEzDV,EAAAA,MAAM,EAAEZ,SAAS,CAACuB,MAFuC;AAGzDN,EAAAA,WAAW,EAAEjB,SAAS,CAACwB,KAAV,CAAgB,CAAC,QAAD,EAAW,UAAX,CAAhB,CAH4C;AAIzDN,EAAAA,GAAG,EAAElB,SAAS,CAACuB;AAJ0C,C;;gBARxCnB,c,kBAewB;AACzCa,EAAAA,WAAW,EAAE,UAD4B;AAEzCD,EAAAA,SAAS,EAAEf,QAAQ,CAACe,SAAT,EAF8B;AAGzCJ,EAAAA,MAAM,EAAE;AAHiC,C;;gBAfxBR,c,kBAqB8B;AAC/CI,EAAAA,QAAQ,EAAER,SAAS,CAACyB;AAD2B,C;;SArB9BrB,c","sourcesContent":["import React, { ReactNode } from 'react';\nimport PropTypes, { Requireable } from 'prop-types';\nimport vkBridge from '@vkontakte/vk-bridge';\nimport { canUseDOM } from '../../lib/dom';\nimport ConfigProviderContext, { ConfigProviderContextInterface } from './ConfigProviderContext';\n\nexport interface ConfigProviderProps extends ConfigProviderContextInterface {\n  children?: ReactNode;\n}\n\nexport interface ConfigProviderContext {\n  document: Document;\n}\n\nexport interface ConfigProviderContextType {\n  document: Requireable<{}>;\n}\n\nexport interface ConfigProviderChildContextType {\n  isWebView: Requireable<boolean>;\n  scheme: Requireable<string>;\n  webviewType: Requireable<'vkapps' | 'internal'>;\n  app: Requireable<string>;\n}\n\nexport default class ConfigProvider extends React.Component<ConfigProviderProps> {\n  constructor(props: ConfigProviderProps, context: ConfigProviderContext) {\n    super(props);\n    if (canUseDOM) {\n      this.setScheme((context.document || window.document).body, this.mapOldScheme(props.scheme));\n    }\n  }\n\n  static childContextTypes: ConfigProviderChildContextType = {\n    isWebView: PropTypes.bool,\n    scheme: PropTypes.string,\n    webviewType: PropTypes.oneOf(['vkapps', 'internal']),\n    app: PropTypes.string,\n  };\n\n  static defaultProps: ConfigProviderProps = {\n    webviewType: 'internal',\n    isWebView: vkBridge.isWebView(),\n    scheme: 'bright_light',\n  };\n\n  static contextTypes: ConfigProviderContextType = {\n    document: PropTypes.object,\n  };\n\n  get document(): Document {\n    return this.context.document || window.document;\n  }\n\n  mapOldScheme(scheme: ConfigProviderProps['scheme']) {\n    switch (scheme) {\n      case 'client_light':\n        return 'bright_light';\n      case 'client_dark':\n        return 'space_gray';\n      default:\n        return scheme;\n    }\n  }\n\n  setScheme(target: HTMLElement, scheme: ConfigProviderProps['scheme']) {\n    target.setAttribute('scheme', scheme);\n  }\n\n  componentDidUpdate(prevProps: ConfigProviderProps) {\n    if (prevProps.scheme !== this.props.scheme) {\n      this.setScheme(this.document.body, this.mapOldScheme(this.props.scheme));\n    }\n  }\n\n  getChildContext(): ConfigProviderProps {\n    return {\n      isWebView: this.props.isWebView,\n      webviewType: this.props.webviewType,\n      scheme: this.mapOldScheme(this.props.scheme),\n      app: this.props.app,\n    };\n  }\n\n  render() {\n    return (\n      <ConfigProviderContext.Provider value={this.getChildContext()}>\n        {this.props.children}\n      </ConfigProviderContext.Provider>\n    );\n  }\n}\n"],"file":"ConfigProvider.js"}